<!DOCTYPE html>
<html lang="ru">
  <head>
    <title>Проект "Комменты"</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="./styles.css">
    <link type="image/png" sizes="48x48" rel="icon" href="./favicon.ico">
  </head>

  <body>
    <div class="container">
      <div class="mode flex">
        <div class="mode-inactive mode-active" id="cute-mode">Cute mode</div>
        <div class="thumb flex">
          <div class="slot" id="slot-button"></div>
          <div class="arm" id="arm-button"></div>
        </div>
        <div class="mode-inactive" id="devil-mode">Devil mode</div>
      </div>

      <div id="app">
        <ul class="comments" id="comment-list">
          <li>Пожалуйста, подождите, идёт первая загрузка...</li>
        </ul>
      </div>

      <div class="add-form">
        <label class="hidden" for="name-input">Имя:</label>
        <input class="input input--short" type="text" placeholder="Введите ваше имя" id="name-input">

        <label class="hidden" for="quote-input">Цитата:</label>
        <input class="input input--short hidden" type="text" id="quote-input">

        <div class="comment-editor">
          <div class="quote flex" id="quote-box">
            <div class="left" id="quote-text">
              <!-- vacant -->
            </div>
            <button class="cancel-quote-button" id="quote-cancel">&times;</button>
          </div>

          <label class="hidden" for="comment-input">Комментарий:</label>
          <textarea class="input input--big" placeholder="Введите ваш коментарий" rows="4" id="comment-input"></textarea>
        </div>

        <div class="row flex">
          <button class="button" id="comment-add">Написать</button>
          <span class="loader hidden" id="loader"></span>
          <button class="button" id="comment-remove">Удалить последний комментарий</button>
        </div>
      </div>
    </div>

    <script>

        const lstComments = document.getElementById("comment-list")

        let counter = -1

        const timerId =  setInterval(() => {
            ++counter

            const dots = (() => {
                const cnt = counter % 3 + 1
                const leftPart = "".padEnd(cnt, ".")

                if (cnt === 3)
                    return leftPart
                else
                    return `${leftPart}<span style="opacity: 0">${"".padEnd(3 - cnt, ".")}</span>`
            })()

            const text = (() => {
                if (counter < 9)
                    return "Пожалуйста, подождите, идёт первая загрузка"
                else
                    return "Загрузка идёт слишком долго, но, пожалуйста, подождите ещё"
            })()

            lstComments.innerHTML = `<li>${text}${dots}</li>`
        }, 400)

        function clearIntroducer() {
            clearInterval(timerId)

            // dispose the function for next times
            clearIntroducer = function () {}
        }

    </script>
    <script type="module" src="./js/main.js"></script>
    <script type="module" src="./js/thumb.js"></script>
  </body>
</html>
